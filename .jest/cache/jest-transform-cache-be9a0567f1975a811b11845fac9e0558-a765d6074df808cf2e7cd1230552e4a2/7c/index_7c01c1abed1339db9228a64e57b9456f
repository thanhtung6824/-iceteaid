102bfb9ecf3d576d519fc3bc9f0f0e90
function _extends() {_extends = Object.assign || function (target) {for (var i = 1; i < arguments.length; i++) {var source = arguments[i];for (var key in source) {if (Object.prototype.hasOwnProperty.call(source, key)) {target[key] = source[key];}}}return target;};return _extends.apply(this, arguments);}!function (e, t) {if ("object" == typeof exports && "object" == typeof module) module.exports = t();else if ("function" == typeof define && define.amd) define([], t);else {var r = t();for (var n in r) {("object" == typeof exports ? exports : e)[n] = r[n];}}}(global, function () {return function (e) {var t = {};function r(n) {if (t[n]) return t[n].exports;var i = t[n] = { i: n, l: !1, exports: {} };return e[n].call(i.exports, i, i.exports, r), i.l = !0, i.exports;}return r.m = e, r.c = t, r.d = function (e, t, n) {r.o(e, t) || Object.defineProperty(e, t, { enumerable: !0, get: n });}, r.r = function (e) {"undefined" != typeof Symbol && Symbol.toStringTag && Object.defineProperty(e, Symbol.toStringTag, { value: "Module" }), Object.defineProperty(e, "__esModule", { value: !0 });}, r.t = function (e, t) {if (1 & t && (e = r(e)), 8 & t) return e;if (4 & t && "object" == typeof e && e && e.__esModule) return e;var n = Object.create(null);if (r.r(n), Object.defineProperty(n, "default", { enumerable: !0, value: e }), 2 & t && "string" != typeof e) for (var i in e) {r.d(n, i, function (t) {return e[t];}.bind(null, i));}return n;}, r.n = function (e) {var t = e && e.__esModule ? function () {return e.default;} : function () {return e;};return r.d(t, "a", t), t;}, r.o = function (e, t) {return Object.prototype.hasOwnProperty.call(e, t);}, r.p = "", r(r.s = 0);}([function (e, t, r) {"use strict";var n = this && this.__createBinding || (Object.create ? function (e, t, r, n) {void 0 === n && (n = r), Object.defineProperty(e, n, { enumerable: !0, get: function get() {return t[r];} });} : function (e, t, r, n) {void 0 === n && (n = r), e[n] = t[r];}),i = this && this.__exportStar || function (e, t) {for (var r in e) {"default" === r || Object.prototype.hasOwnProperty.call(t, r) || n(t, e, r);}};Object.defineProperty(t, "__esModule", { value: !0 }), i(r(6), t), i(r(9), t), i(r(2), t), i(r(10), t), i(r(5), t);}, function (e, t) {e.exports = require("iceteaid-type");}, function (e, t, r) {"use strict";var _n,i = this && this.__extends || (_n = function n(e, t) {return (_n = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function (e, t) {e.__proto__ = t;} || function (e, t) {for (var r in t) {Object.prototype.hasOwnProperty.call(t, r) && (e[r] = t[r]);}})(e, t);}, function (e, t) {function r() {this.constructor = e;}_n(e, t), e.prototype = null === t ? Object.create(t) : (r.prototype = t.prototype, new r());});Object.defineProperty(t, "__esModule", { value: !0 }), t.viewIsNotReady = t.invalidParameter = t.missingParameter = t.missingApiKeyError = t.ExceptionHandler = void 0;var o = r(1),a = function (e) {function t(r, n) {var i = e.call(this, "IceteaID Error: [" + r + "] " + n) || this;return Object.setPrototypeOf(i, t.prototype), i;}return i(t, e), t;}(Error);t.ExceptionHandler = a, t.missingApiKeyError = function () {return new a(o.ExceptionType.MISSING_API_KEY, "You must provide a api key");}, t.missingParameter = function (e) {return new a(o.ExceptionType.MISSING_PARAMETER, "Parameter " + e + " is required");}, t.invalidParameter = function (e) {return new a(o.ExceptionType.INVALID_PARAMETER, "Parameter " + e + " is invalid");}, t.viewIsNotReady = function () {return new a(o.ExceptionType.VIEW_NOT_READY, "View is not ready");};}, function (e, t, r) {"use strict";Object.defineProperty(t, "__esModule", { value: !0 }), t.BaseApi = void 0;var n = function () {function e(e) {this.iceteaId = e;}return Object.defineProperty(e.prototype, "iframe", { get: function get() {return this.iceteaId.iframe;}, enumerable: !1, configurable: !0 }), Object.defineProperty(e.prototype, "transporter", { get: function get() {return this.iceteaId.transporter;}, enumerable: !1, configurable: !0 }), e;}();t.BaseApi = n;}, function (e, t) {e.exports = require("rxjs");}, function (e, t, r) {"use strict";var n = this && this.__createBinding || (Object.create ? function (e, t, r, n) {void 0 === n && (n = r), Object.defineProperty(e, n, { enumerable: !0, get: function get() {return t[r];} });} : function (e, t, r, n) {void 0 === n && (n = r), e[n] = t[r];}),i = this && this.__exportStar || function (e, t) {for (var r in e) {"default" === r || Object.prototype.hasOwnProperty.call(t, r) || n(t, e, r);}};Object.defineProperty(t, "__esModule", { value: !0 }), i(r(12), t);}, function (e, t, r) {"use strict";Object.defineProperty(t, "__esModule", { value: !0 }), t.sdkBuilder = t.SdkConfiguration = t.SdkBase = void 0;var n = r(2),i = r(7),o = r(8),a = function () {function e(r) {if (!r) throw n.missingApiKeyError();this.apiKey = r, this.endpoint = t.SdkConfiguration.baseUrl, this.user = new i.UserApi(this), this.auth = new o.AuthApi(this), this.sdkId = btoa(JSON.stringify({ apiKey: r, target: t.SdkConfiguration.target, baseUrl: t.SdkConfiguration.baseUrl })), e.instance = this;}return e.getInstance = function (t) {return e.instance || (e.instance = new e(t)), e.instance;}, Object.defineProperty(e.prototype, "transporter", { get: function get() {return e._transport.has(this.sdkId) || e._transport.set(this.sdkId, new t.SdkConfiguration.Transporter(this.endpoint)), e._transport.get(this.sdkId);}, enumerable: !1, configurable: !0 }), Object.defineProperty(e.prototype, "iframe", { get: function get() {return e._iframe.has(this.sdkId) || e._iframe.set(this.sdkId, new t.SdkConfiguration.Iframe(this.endpoint, this.sdkId, this.transporter)), e._iframe.get(this.sdkId);}, enumerable: !1, configurable: !0 }), e._transport = new Map(), e._iframe = new Map(), e;}();t.SdkBase = a, t.SdkConfiguration = {}, t.sdkBuilder = function (e, r) {return _extends(t.SdkConfiguration, r), e;};}, function (e, t, r) {"use strict";var _n2,i = this && this.__extends || (_n2 = function n(e, t) {return (_n2 = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function (e, t) {e.__proto__ = t;} || function (e, t) {for (var r in t) {Object.prototype.hasOwnProperty.call(t, r) && (e[r] = t[r]);}})(e, t);}, function (e, t) {function r() {this.constructor = e;}_n2(e, t), e.prototype = null === t ? Object.create(t) : (r.prototype = t.prototype, new r());});Object.defineProperty(t, "__esModule", { value: !0 }), t.UserApi = void 0;var o = r(3),a = r(1),s = r(0),u = function (e) {function t() {return null !== e && e.apply(this, arguments) || this;}return i(t, e), t.prototype.generateEncryptionKey = function () {var e = s.queryBuilder(a.RequestType.GENERATE_ENCRYPTION_KEY, {});return this.transporter.post(this.iframe, e);}, t.prototype.encryptKey = function (e, t, r) {if (!e) throw s.missingParameter("PRIVATE_KEY");if (!t) throw s.missingParameter("ENCRYPTION_KEY");var n = s.queryBuilder(a.RequestType.ENCRYPT_KEY, { privateKey: e, encryptionKey: t, mnemonic: r || "" });return this.transporter.post(this.iframe, n);}, t.prototype.decryptKey = function (e, t, r) {if (!e) throw s.missingParameter("PRIVATE_KEY");if (!t) throw s.missingParameter("ENCRYPTION_KEY");var n = s.queryBuilder(a.RequestType.DECRYPT_KEY, { privateKey: e, encryptionKey: t, mnemonic: r || "" });return this.transporter.post(this.iframe, n);}, t.prototype.getKey = function () {var e = s.queryBuilder(a.RequestType.GET_KEY, {});return this.transporter.post(this.iframe, e);}, t.prototype.updateInfo = function (e, t) {if (!e && !t) throw s.missingParameter("AT_LEAST_ONE_PARAMETER");var r = s.queryBuilder(a.RequestType.UPDATE_INFO, { displayName: e, fullName: t });return this.transporter.post(this.iframe, r);}, t.prototype.getMetaData = function () {var e = s.queryBuilder(a.RequestType.GET_META_DATA, {});return this.transporter.post(this.iframe, e);}, t.prototype.getDataAfterRedirect = function () {var e = s.queryBuilder(a.RequestType.WEB_GET_DATA_AFTER_REDIRECT, {});return this.transporter.post(this.iframe, e);}, t;}(o.BaseApi);t.UserApi = u;}, function (e, t, r) {"use strict";var _n3,i = this && this.__extends || (_n3 = function n(e, t) {return (_n3 = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function (e, t) {e.__proto__ = t;} || function (e, t) {for (var r in t) {Object.prototype.hasOwnProperty.call(t, r) && (e[r] = t[r]);}})(e, t);}, function (e, t) {function r() {this.constructor = e;}_n3(e, t), e.prototype = null === t ? Object.create(t) : (r.prototype = t.prototype, new r());});Object.defineProperty(t, "__esModule", { value: !0 }), t.AuthApi = void 0;var o = r(3),a = r(0),s = r(1),u = function (e) {function t() {return null !== e && e.apply(this, arguments) || this;}return i(t, e), t.prototype.sendOtp = function (e, t) {if (!e) throw a.missingParameter("EMAIL_OR_PHONE");if (!t) throw a.missingParameter("CHANNEL");var r = a.queryBuilder(s.RequestType.SEND_OTP, { emailOrPhone: e, channel: t });return this.transporter.post(this.iframe, r);}, t.prototype.verifyOtp = function (e, t, r) {if (!e) throw a.missingParameter("EMAIL_OR_PHONE");if (!t) throw a.missingParameter("CHANNEL");var n = a.queryBuilder(s.RequestType.VERIFY_OTP, { emailOrPhone: e, channel: t, verifyCode: r });return this.transporter.post(this.iframe, n);}, t.prototype.loginWithGoogle = function (e) {if ("react-native" === a.SdkConfiguration.target && e) throw a.invalidParameter("REDIRECT_URI");if ("react-native" === a.SdkConfiguration.target && !e) {var t = a.queryBuilder(s.RequestType.LOGIN_WITH_GOOGLE, {});return this.transporter.post(this.iframe, t);}if (!e) throw a.missingParameter("REDIRECT_URI");window.location.href = "http://3k1.theydont.work/account/google?sdkId=" + this.iceteaId.sdkId + "&redirectUri=" + e;}, t.prototype.logout = function () {var e = a.queryBuilder(s.RequestType.LOG_OUT, {});return this.transporter.post(this.iframe, e);}, t;}(o.BaseApi);t.AuthApi = u;}, function (e, t, r) {"use strict";Object.defineProperty(t, "__esModule", { value: !0 }), t.Iframe = void 0;var n = function n(e, t, r) {this.endpoint = e, this.sdkId = t, this.transporter = r, this.bootstrap && this.bootstrap();};t.Iframe = n;}, function (e, t, r) {"use strict";var n = this && this.__awaiter || function (e, t, r, n) {return new (r || (r = Promise))(function (i, o) {function a(e) {try {u(n.next(e));} catch (e) {o(e);}}function s(e) {try {u(n.throw(e));} catch (e) {o(e);}}function u(e) {var t;e.done ? i(e.value) : (t = e.value, t instanceof r ? t : new r(function (e) {e(t);})).then(a, s);}u((n = n.apply(e, t || [])).next());});},i = this && this.__generator || function (e, t) {var r,n,i,o,a = { label: 0, sent: function sent() {if (1 & i[0]) throw i[1];return i[1];}, trys: [], ops: [] };return o = { next: s(0), throw: s(1), return: s(2) }, "function" == typeof Symbol && (o[Symbol.iterator] = function () {return this;}), o;function s(o) {return function (s) {return function (o) {if (r) throw new TypeError("Generator is already executing.");for (; a;) {try {if (r = 1, n && (i = 2 & o[0] ? n.return : o[0] ? n.throw || ((i = n.return) && i.call(n), 0) : n.next) && !(i = i.call(n, o[1])).done) return i;switch (n = 0, i && (o = [2 & o[0], i.value]), o[0]) {case 0:case 1:i = o;break;case 4:return a.label++, { value: o[1], done: !1 };case 5:a.label++, n = o[1], o = [0];continue;case 7:o = a.ops.pop(), a.trys.pop();continue;default:if (!(i = a.trys, (i = i.length > 0 && i[i.length - 1]) || 6 !== o[0] && 2 !== o[0])) {a = 0;continue;}if (3 === o[0] && (!i || o[1] > i[0] && o[1] < i[3])) {a.label = o[1];break;}if (6 === o[0] && a.label < i[1]) {a.label = i[1], i = o;break;}if (i && a.label < i[2]) {a.label = i[2], a.ops.push(o);break;}i[2] && a.ops.pop(), a.trys.pop();continue;}o = t.call(e, a);} catch (e) {o = [6, e], n = 0;} finally {r = i = 0;}}if (5 & o[0]) throw o[1];return { value: o[0] ? o[1] : void 0, done: !0 };}([o, s]);};}};Object.defineProperty(t, "__esModule", { value: !0 }), t.Transporter = void 0;var o = r(4),a = r(11),s = r(5),u = function () {function e(e) {this.endpoint = e, this.messageHandlers = new Map(), this.bootstrap && this.bootstrap();}return e.prototype.post = function (e, t) {return n(this, void 0, void 0, function () {var r,n,u = this;return i(this, function (i) {switch (i.label) {case 0:return [4, e.isReady()];case 1:return i.sent(), r = t.id, n = s.subjectBuilder(r, this.messageHandlers), e.postMessage(JSON.stringify(t)), [2, o.lastValueFrom(n.asObservable().pipe(a.filter(function (e) {return !!e;}), a.map(function (e) {return e.payload && e.payload.err ? o.lastValueFrom(o.throwError(e)) : e;}), a.take(1), a.tap(function () {u.messageHandlers.delete(r);})))];}});});}, e.prototype.on = function (e) {var t = JSON.parse(e),r = this.messageHandlers.get(t.id);r && r.next(t);}, e;}();t.Transporter = u;}, function (e, t) {e.exports = require("rxjs/operators");}, function (e, t, r) {"use strict";Object.defineProperty(t, "__esModule", { value: !0 }), t.subjectBuilder = t.queryBuilder = t.randomId = void 0;var n = r(4);function i() {return Math.random().toString(36).replace(/[^a-z]+/g, "").substr(0, 10);}t.randomId = i, t.queryBuilder = function (e, t) {return { payload: t, id: i(), requestType: e };}, t.subjectBuilder = function (e, t) {var r = new n.BehaviorSubject("");return t.set(e, r), r;};}]);});