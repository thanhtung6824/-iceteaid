{"version":3,"sources":["/home/admin1/Desktop/@iceteaid/packages/web/test/web-iframe.test.ts"],"names":[],"mappings":"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","sourcesContent":["/**\n * @jest-environment jsdom\n */\nimport { createWebIframe } from './mock';\n\nbeforeEach(() => {\n    const iframe = document.getElementById('aaa');\n    if (iframe && iframe.parentNode) {\n        iframe.parentNode.removeChild(iframe);\n    }\n});\n\nit('Create Iframe correctly', async () => {\n    const iceteaId = await createWebIframe();\n    const iframe = (iceteaId as any).iframe;\n\n    expect(iframe.id).toEqual('aaa');\n    expect(iframe.getAttribute('src')).toEqual('xxx/web');\n    expect(iframe.style.width).toEqual('640px');\n    expect(iframe.style.height).toEqual('480px');\n    expect(iframe.style.display).toEqual('none');\n});\n\nit ('Throw error if open, close iframe not ready', async () => {\n    const iceteaId = await createWebIframe();\n    const iframe = document.getElementById('aaa');\n    if (iframe && iframe.parentNode) {\n        iframe.parentNode.removeChild(iframe);\n    }\n    try {\n        (iceteaId as any).openIframe();\n    } catch (err) {\n        expect(err).toBeInstanceOf(Error);\n        expect(err.message).toBe('IceteaID Error: [VIEW_NOT_READY] View is not ready');\n    }\n\n    try {\n        (iceteaId as any).closeIframe();\n    } catch (err) {\n        expect(err).toBeInstanceOf(Error);\n        expect(err.message).toBe('IceteaID Error: [VIEW_NOT_READY] View is not ready');\n    }\n});\n\nit ('Open, Close Iframe when click', async () => {\n    const iceteaId = await createWebIframe();\n    const iframe = (iceteaId as any).iframe;\n\n    (iceteaId as any).openIframe();\n    expect(iframe.style.display).toEqual('block');\n    (iceteaId as any).closeIframe();\n    expect(iframe.style.display).toEqual('none');\n});\n\nit('Is ready func worked', async () => {\n    const iceteaId = await createWebIframe();\n    const iframe = (iceteaId as any).iframe;\n    const map = {} as any;\n    iframe.addEventListener = jest.fn((event: string, cb: any) => {\n        map[event] = cb;\n    });\n    iceteaId.isReady();\n    map.load();\n    expect((iceteaId as any).isIframeReady).toEqual(true);\n});\n\nit ('Is ready will resolve when iframe loaded', async () => {\n    const iceteaId = await createWebIframe();\n    (iceteaId as any).isIframeReady = true;\n    await expect(iceteaId.isReady()).resolves.toBe(true);\n});\n\nit('Didnt post message when view is not ready', async () => {\n    const iceteaId = await createWebIframe() as any;\n    iceteaId.isReady = jest.fn(() => Promise.resolve());\n    iceteaId.iframe = undefined;\n    try {\n        await iceteaId.postMessage(JSON.stringify({ id: 123, msg: 'Here is test' }));\n        expect(true).toBe(false);\n    } catch (err) {\n        expect(err).toBeInstanceOf(Error);\n        expect(err.message).toBe('IceteaID Error: [VIEW_NOT_READY] View is not ready');\n    }\n});\n\nit ('Will post message with expected arguments', async () => {\n    const iceteaId = await createWebIframe();\n    iceteaId.isReady = jest.fn(() => Promise.resolve());\n    const mockPostmessage = jest.fn();\n    (iceteaId as any).iframe = { contentWindow: { postMessage: mockPostmessage } };\n    await iceteaId.postMessage(JSON.stringify({ id: 123, msg: 'Here is test' }));\n\n    expect(mockPostmessage).toBeCalledWith(JSON.stringify({ id: 123, msg: 'Here is test' }), 'xxx/web');\n});"]}